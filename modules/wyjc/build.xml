<project name="wyjc" default="build">  
  <import file="../../config.xml"/>  

  <target name="compile-wyjc">
    <javac debug="true" debuglevel="vars,lines,source" includeantruntime="true" includes="*/**" excludes="wyjc/testing/**" classpath="../wyil/src:../wyc/src"> 
      <src path="src"/>
    </javac>
    <taskdef name="wyjc" classname="wyjc.util.AntTask" classpath="src/:../wyil/src/:../wyc/src"/>
    <wyjc verbose="true" wyildir="../wyrt/src" classdir="src/" includes="whiley/**/*.wyil"/>
  </target>

  <target name="build" depends="compile-wyjc">
    <jar destfile="../../lib/wyjc-v${version}.jar">
      <fileset dir="src" includes="*/**/*.class"/>
    </jar>
    <echo message="============================================="/>
    <echo message="BUILT: ${ant.project.name}-v${version}"/>
    <echo message="============================================="/>
  </target>
  
  <target name="doc">
    <javadoc
       packagenames="wyjc.*,wyjvm.*"
       excludepackagenames="wyjc.testing.*"
       sourcepath="src/"
       destdir="../../docs/wyjc/api"
       author="true"
       version="true"
       use="true"
       windowtitle="Whiley-2-Java Compiler API">
      <doctitle><![CDATA[<h1>The Whiley-2-Java Compiler (v${version})</h1>]]></doctitle>
      <bottom><![CDATA[<i>Copyright &#169; 2011 David J. Pearce. All Rights Reserved.</i>]]></bottom>
      </javadoc>
  </target>

 <target name="clean">
   <delete includeEmptyDirs="true" failonerror="false">
     <fileset dir="." includes="**/*.class,**/*.wyil,**/*.wyasm"/>
   </delete>
    <echo message="============================================="/>
    <echo message="CLEANED: ${ant.project.name}"/>
    <echo message="============================================="/>
 </target>

</project>
